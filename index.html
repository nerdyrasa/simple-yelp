<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
</head>
<body>

<script
        src="https://code.jquery.com/jquery-3.1.1.min.js"
        integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
        crossorigin="anonymous"></script>

<!--https://discussions.udacity.com/t/yelp-api-not-working/163965/4-->
<!--https://github.com/bettiolo/oauth-signature-js/tree/master/dist-->
<script src="js/oauth-signature.min.js"></script>
<script src="js/test1.js"></script>
<script src="js/jso.js"></script>

<!--
Yelp
API v2.0
Consumer Key	Zwcl1st6vGfHoXGgOe6YKA
Consumer Secret	eWwJXkpiSzV83uz-oetgkaZEt6M
Token	uOEA_bV6OnwIlsQ2Am2vt-cy8Agjmt11
Token Secret	FSyNzwQFbBtId5RE4By7Ziy2mIU
-->
<!--
Making a Request
Each request must contain the following OAuth protocol parameters:

OAuth Parameter	Value
oauth_consumer_key	Your OAuth consumer key (from Manage API Access).
oauth_token	The access token obtained (from Manage API Access).
oauth_signature_method	hmac-sha1
oauth_signature	The generated request signature, signed with the oauth_token_secret obtained (from Manage API Access).
oauth_timestamp	Timestamp for the request in seconds since the Unix epoch.
oauth_nonce	A unique string randomly generated per request.
These parameters may be passed in the HTTP (Authorization) header as URL query keys or in the POST data. Generating the OAuth signature is done by applying the HMAC-SHA1 with the oauth_token_secret. You may view your OAuth consumer key at Manage API Access. OAuth libraries are available to generate these requests.

Don’t worry, this isn’t as difficult as it seems. We’ve set up sample codes in popular programming languages to take care of the authentication process for you.-->


<!--
<script>
    var jso = new JSO({
        providerID: "yelp",
        client_id: "541950296471.apps.googleusercontent.com",
        redirect_uri: "http://bridge.uninett.no/jso/index.html",
        authorization: "https://accounts.google.com/o/oauth2/auth",
        scopes: { request: ["https://www.googleapis.com/auth/userinfo.profile"]}
    });
    console.log(jso);

    jso.callback();

    JSO.enablejQuery($);

    jso.ajax({
        url: "https://www.googleapis.com/oauth2/v1/userinfo",
        oauth: {
            scopes: {
                request: ["https://www.googleapis.com/auth/userinfo.email"],
                require: ["https://www.googleapis.com/auth/userinfo.email"]
            }
        },
        dataType: 'json',
        success: function(data) {
            console.log("Response (google):");
            console.log(data);
            $(".loader-hideOnLoad").hide();
        }
    });


</script>-->

<!--https://discussions.udacity.com/t/how-to-make-ajax-request-to-yelp-api/13699/5-->

<script>
    function nonce_generate() {
        return (Math.floor(Math.random() * 1e12).toString());
    }
    var yelp_url = 'https://api.yelp.com/v2/search/?term=tacos&location=kenosha, wi';
    <!--var yelp_url = YELP_BASE_URL + 'business/' + self.selected_place().Yelp.business_id;-->

    /*Yelp
     API v2.0*/

    var YELP_KEY = "Zwcl1st6vGfHoXGgOe6YKA",  // goes into parameters variable
            YELP_TOKEN = "uOEA_bV6OnwIlsQ2Am2vt-cy8Agjmt11", // goes into parameters variable
            YELP_KEY_SECRET = "eWwJXkpiSzV83uz-oetgkaZEt6M",  // goes into oauthSignature.generate() method
            YELP_TOKEN_SECRET = "FSyNzwQFbBtId5RE4By7Ziy2mIU"; // goes into oauthSignature.generate() method

//    Consumer Key	Zwcl1st6vGfHoXGgOe6YKA
//    Consumer Secret	eWwJXkpiSzV83uz-oetgkaZEt6M
//    Token	uOEA_bV6OnwIlsQ2Am2vt-cy8Agjmt11
//    Token Secret	FSyNzwQFbBtId5RE4By7Ziy2mIU

//    var YELP_KEY = 'Zwcl1st6vGfHoXGgOe6YKA';
//    var YELP_KEY_SECRET = 'eWwJXkpiSzV83uz-oetgkaZEt6M';
//    var YELP_TOKEN = 'uOEA_bV6OnwIlsQ2Am2vt-cy8Agjmt11';
//    var YELP_TOKEN_SECRET = 'FSyNzwQFbBtId5RE4By7Ziy2mIU';
    // use yelp api console to do queries
    var parameters = {
        oauth_consumer_key: YELP_KEY,
        oauth_token: YELP_TOKEN,
        oauth_nonce: nonce_generate(),
        oauth_timestamp: Math.floor(Date.now()/1000),
        oauth_signature_method: 'HMAC-SHA1',
        oauth_version : '1.0',
        callback: 'cb' // This is crucial to include for jsonp implementation in AJAX or else the oauth-signature will be wrong.
    };

    var encodedSignature = oauthSignature.generate('GET',yelp_url, parameters, YELP_KEY_SECRET, YELP_TOKEN_SECRET);
    parameters.oauth_signature = encodedSignature;

    var settings = {
        url: yelp_url,
        data: parameters,
        cache: true,                // This is crucial to include as well to prevent jQuery from adding on a cache-buster parameter "_=23489489749837", invalidating our oauth-signature
        dataType: 'jsonp',
        success: function(results) {
// Do stuff with results
            console.log("success");
        },
        fail: function() {
            console.log("fail");
        }
    };

    // Send AJAX query via jQuery library.
    $.ajax(settings);










</script>


</body>
</html>





<!--
Use this lib to handle authentication

https://github.com/andreassolberg/jso/blob/master/README-getting-started.md-->


<!--udacity forum code-->

<!--/**
* Generates a random number and returns it as a string for OAuthentication
* @return {string}
*/-->

<!--
<script>
function nonce_generate() {
return (Math.floor(Math.random() * 1e12).toString());
}
var yelp_url = 'https://api.yelp.com/v2/search/?term=tacos&location=kenosha, wi';
&lt;!&ndash;var yelp_url = YELP_BASE_URL + 'business/' + self.selected_place().Yelp.business_id;&ndash;&gt;

/*Yelp
API v2.0*/
var YELP_KEY = 'Zwcl1st6vGfHoXGgOe6YKA';
var YELP_KEY_SECRET = 'eWwJXkpiSzV83uz-oetgkaZEt6M';
var YELP_TOKEN = 'uOEA_bV6OnwIlsQ2Am2vt-cy8Agjmt11';
var YELP_TOKEN_SECRET = 'FSyNzwQFbBtId5RE4By7Ziy2mIU';




var parameters = {
oauth_consumer_key: YELP_KEY,
oauth_token: YELP_TOKEN,
oauth_nonce: nonce_generate(),
oauth_timestamp: Math.floor(Date.now()/1000),
oauth_signature_method: 'HMAC-SHA1',
oauth_version : '1.0',
callback: 'cb'              // This is crucial to include for jsonp implementation in AJAX or else the oauth-signature will be wrong.
};

var encodedSignature = oauthSignature.generate('GET',yelp_url, parameters, YELP_KEY_SECRET, YELP_TOKEN_SECRET);
parameters.oauth_signature = encodedSignature;

var settings = {
url: yelp_url,
data: parameters,
cache: true,                // This is crucial to include as well to prevent jQuery from adding on a cache-buster parameter "_=23489489749837", invalidating our oauth-signature
dataType: 'jsonp',
success: function(results) {
// Do stuff with results
console.log("success");
},
fail: function() {
console.log("fail");
}
};

// Send AJAX query via jQuery library.
$.ajax(settings);

</script>-->
